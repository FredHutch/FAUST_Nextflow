docker.enabled = true

process {
    executor = "slurm"
    errorStrategy = { task.attempt <= 3 ? "retry" : "terminate" }
    // ---
    withLabel: micro_mem_and_cpu {
        cpus = { 4 * task.attempt }
        memory = {2.GB * task.attempt }
    }
    // 1000 vCPU == 62 concurrent workers
    withLabel: standard_mem_and_cpu {
        cpus = { 16 * task.attempt }
        memory = {32.GB * task.attempt }
    }
    // 1000 vCPU == 31 concurrent workers
    withLabel: large_cpu {
        cpus = { 32 * task.attempt }
        memory = {64.GB * task.attempt }
    }
    // 1000 vCPU == 16 concurrent workers
    withLabel: extra_large_cpu {
        cpus = { 64 * task.attempt }
        memory = {128.GB * task.attempt }
    }
    withLabel: high_memory {
        cpus = { 16 * task.attempt }
        memory = 256.GB
    }
}

manifest {
    author = "Greg Finak, Evan Greene, Logan Knecht,"
    defaultBranch = "master"
    mainScript = "main.nf"
    name = "FAUST"
    version = "1.0.0"
}
